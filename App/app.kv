
<CountryCard>:
    # text: "Friend"
    
    # divider: None
    on_release: app.show_country(self.text)
    pos_hint: {'center_x': 0.5}
    syze_hint_x: 1
    # elevation: 10
    disabled: True if self.text and  len(app.ports[self.text]) == 0 else False

    MDLabel:
        text: root.text
        halign: 'center'


           
        
<RVConutry>:
    viewclass: 'CountryCard'
    RecycleGridLayout:
        default_size: None, dp(80)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        # orientation: 'vertical'
        spacing: dp(10)
        cols: 4
        pos_hint: {'center_x': 0.5}

  

<CountryScreen@MDBoxLayout>:
    orientation: 'vertical'
    size_hint: 1, 1
    padding: 0
    spacing: dp(10)
    md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]


    MDToolbar:
        title: "Country Screen"
        left_action_items: [["menu", lambda x: app.show_date_picker()]]

        # right_action_items: [["dots-vertical", lambda x: app.callback_1()], ["clock", lambda x: app.callback_2()]]
        # right_action_items: [["magnify", lambda x: app.search()]]
    

    
    MDBoxLayout :
        size_hint: 1, 1
        orientation: 'vertical'
        MDBoxLayout:
            size_hint: 1, None
            height: self.minimum_height
     
  

            # mb_bg_color: [1.0, 0, 1.0, 1.0]

            MDIconButton:
                # size_hint: None, None
            
                icon: 'magnify'

            MDTextField:
                
                id: search_field
                hint_text: 'Search icon'
                on_text: rv_country.search(self.text)

        
        RVConutry:
            id : rv_country
    




<PortCard>:

    on_release: app.go_model_1(self.country,self.text)
 

    disabled: True if self.text and self.country and len(app.ports[self.country][self.text]) == 0 else False

    MDLabel:
        text: root.text
        halign: 'center'


<RVPort>:
    viewclass: 'PortCard'
    RecycleGridLayout:
        default_size: None, dp(80)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        # orientation: 'vertical'
        spacing: dp(10)
        cols: 2

<PortScreen@MDBoxLayout>:
    orientation: 'vertical'
    size_hint: 1, 1
    padding: 0
    spacing: dp(10)
    md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]

    country: ''
    MDToolbar:
        title:  root.country +" Ports"
        left_action_items: [["arrow-left", lambda x: app.go_menu()]]


        # right_action_items: [["magnify", lambda x: app.search()]]
    MDBoxLayout :
        size_hint: 1, 1
        orientation: 'vertical'
        MDBoxLayout:
            id: search_box
            size_hint: 1, None
            height: self.minimum_height
            
     
  

            # mb_bg_color: [1.0, 0, 1.0, 1.0]

            MDIconButton:
                # size_hint: None, None
            
                icon: 'magnify'

            MDTextField:
                
                id: search_field
                hint_text: 'Search icon'
                on_text: rv_.search(self.text)

        
        RVPort:
            id : rv_
    


<GraphModel_1>:
    orientation: 'vertical'
    size_hint: 1,1  
    height: dp(200)
    padding: dp(10)
    spacing: dp(10)
    md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]



<ConstituantChip>:

    on_release: app.calculate2(self.text)
    icon: ''
    check: True
    active: True
    # tooltip_text: root.text2
    



# <RVConstituant>:
#     viewclass: 'ConstituantChip'
#     RecycleGridLayout:
#         default_size: None, dp(30)
#         default_size_hint: 1, None
#         size_hint_y: None
#         height: self.minimum_height
#         # orientation: 'vertical'
#         spacing: dp(10)
#         cols: 7

<Model_1@MDBoxLayout>:
    orientation: 'vertical'
    country: ''
    port: ''
    MDToolbar:
        title:  root.country +" -- "+ root.port
        left_action_items: [["arrow-left", lambda x: app.show_country(root.country)]]

        # right_action_items: [["dots-vertical", lambda x: app.callback_1()], ["clock", lambda x: app.callback_2()]]
        # right_action_items: [["magnify", lambda x: app.search()]]

        right_action_items: [["printer", lambda x: app.callback_1()], ["calendar-month", lambda x: app.callback_2()]]
    GraphModel_1 :
        id: graph
        size_hint: 1, .6
    MDBoxLayout :
        size_hint: 1, .4
        # orientation: 'vertical'
        padding: dp(10)

        md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]
        RVConstituant :


<MenuCard@MDCard>:
    orientation: 'vertical'
    size_hint: 1, 1
    padding: dp(10)
    spacing: dp(10)
    elevation: 0
    text: ''

    MDLabel:
        text: root.text
        # halign: 'center'

<MyDatePicker@MDBoxLayout>:
    text: ''

    orientation: 'vertical'
    size_hint: 1, None
    height: dp(80)


    MDGridLayout:
        cols: 2
        MDTextField:

            size_hint: 1, None
            hint_text:  root.text
            height: "30dp"
            text: app.start_date

        MDIconButton:
            icon: "calendar-month"
            on_press: app.show_date_picker(root.text)


<Single_maree>:
    cols: 3
    size_hint: 1, None
    height: dp(30)
    spacing: dp(10)


    md_bg_color:  [0.8784313725490196, 0.8784313725490196, 0, 1.0] if root.index % 2 == 0 else [1,1,1, 1.0]
    MDLabel:
        size_hint: 1, 1
        height: dp(15)
        text: root.designation
        halign: 'center'
    MDLabel:
        size_hint: 1, 1                             
        height: dp(15)
        text: root.heure
        halign: 'center'
    MDLabel:
        size_hint: 1, 1
        
        text: root.hauteur
        halign: 'center'

<Search_dropdown>:
    # elevation: 10

    MDBoxLayout:
        orientation: 'vertical'
        spacing: dp(10)
        # padding: dp(20)
        md_bg_color: [1.0, 1.0, 1.0, 1.0]
        MDBoxLayout:
            size_hint: 1, None
            height: self.minimum_height
  
            # mb_bg_color: [1.0, 0, 1.0, 1.0]

            MDIconButton:
                # size_hint: None, None
            
                icon: 'magnify'

            MDTextField:
                
                id: search_field
                hint_text: 'Search icon'
                on_text: root.set_list_md_icons(self.text, True)
        

        RecycleView:
            id: rv
            key_viewclass: 'viewclass'
            key_size: 'height'

            RecycleBoxLayout:
                padding: dp(10)
                default_size: None, dp(48)
                default_size_hint: 1, None
                size_hint_y: None
                height: self.minimum_height
                orientation: 'vertical'

<HomeScreen@MDBoxLayout>:

    orientation: 'vertical'
    size_hint: 1, 1
    padding: 0
    spacing: dp(10)
    md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]
    MDBoxLayout:
        size_hint: 1, 1
        orientation: 'vertical'
        GraphModel_1 :
            id: graph
            size_hint: 1, .6
        MDBoxLayout :
        
            size_hint: 1, .4
            padding: dp(10)
            spacing: dp(10)
            
            MDBoxLayout:
                orientation: 'vertical'
                size_hint: .3, 1
                ScrollView:
         
                    do_scroll_x: True
                    do_scroll_y: False
                    MDBoxLayout:
                        orientation: 'vertical'
                       
                        spacing: dp(20)
                        MDCard:
                            padding: "5dp"
                            size_hint_x : 1
                            size_hint_y : None
                            height: dp(30)
                            # width: self.minimum_width
                            # md_bg_color: [1.0, 1.0, 0, 1]
                            on_release:  app.search_dropdown.Oopen("country")
                            elevation: 0
                            MDLabel:
                                text: app.selected_country 

                        MDCard:
                            padding: "5dp"
                            size_hint_x : 1
                            size_hint_y : None
                            height: dp(30)
                            on_release:  app.search_dropdown.Oopen("port")
                            elevation: 0
                            MDLabel:
                                text: app.selected_port 


                        MDRaisedButton:
                            size_hint_x : 1
                            text: "Nouveau"
                            theme_text_color: "Custom"
                            text_color: 1, 1, 1, 1
                            md_bg_color: 0,.1 , 1, 1
                            on_release: app.open_add_port()

                        # MDRaisedButton:
                        #     size_hint_x : 1
                        #     text: "train"
                        #     theme_text_color: "Custom"
                        #     text_color: 1, 1, 1, 1
                        #     md_bg_color: 0,.1 , 1, 1
                        #     on_release: app.otrain()




                        MDBoxLayout:
                            size_hint: 1, 1
                            padding: 0,dp(10)
                            MyDatePicker:
                                size_hint: 1, None
                                height: dp(30)
                                text: 'From'
            MDCard:
                size_hint: 1, 1
                # height: self.minimum_height
                padding: dp(10)
                # RVConstituant :
                MDRelativeLayout:
                    size_hint: .1, 1
                    MDIconButton:
                        icon: 'arrow-left'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        on_release: app.change_day(-1)

                MDBoxLayout:
                    size_hint: .8, 1
                    cols: 1
                    orientation: 'vertical'
                    spacing: dp(10)
                    MDLabel:
                        size_hint_y: None
                        height: dp(20)
                        text: str(app.start_date)
                        halign: 'center' 
                        md_bg_color: [0.8784313725490196, 0.8784313725490196, 0.8784313725490196, 1.0]

                                       
                    MDBoxLayout:
                        size_hint: 1, 1
                        padding: 0,dp(10)
                        orientation: 'vertical'
                        MDGridLayout:
                            cols: 3
                            size_hint: 1, None
                            height: dp(30)
                            spacing: dp(10)
                            md_bg_color: [0.8784313725490196, 0.8784313725490196, 0.8784313725490196, 1.0]

                            MDLabel:
                                size_hint: 1, 1
                                height: dp(15)
                                text: "Marée"
                                halign: 'center'
                            MDLabel:
                                size_hint: 1, 1
                                height: dp(15)
                                text: "heure"
                                halign: 'center'
                            MDLabel:
                                size_hint: 1, 1
                                
                                text: "Hauteur"
                                halign: 'center'
                            
                        MDBoxLayout:
                            size_hint: 1, 1
                            ScrollView:
                                MDBoxLayout:
                                    orientation: 'vertical'
                                    size_hint: 1,None
                                    height: self.minimum_height
                                    id: maree_list
    

  
               
                    

                MDRelativeLayout:
                    size_hint: .1, 1
                    MDIconButton:
                        icon: 'arrow-right'
                        pos_hint: {'center_x': 0.5, 'center_y': 0.5}
                        on_release: app.change_day(1)

            MDRelativeLayout:
                size_hint: .2, 1
                cols: 1
                spacing: dp(10)
      
 

                MDRaisedButton:
                    size_hint_x : 1
                    text: "Exporter"
                    theme_text_color: "Custom"
                    text_color: 1, 1, 1, 1
                    md_bg_color: 0.71, 0.71, 0.012, 1
                    pos_hint: {'center_y': 0.5}
                    on_release: app.export_data()

                    # on_release: app.predcition(graph)


<Export_DAY>: 
    size_hint: 1, 1
    MDBoxLayout:
        

        orientation: 'vertical'
        size_hint: 1, 1
        spacing: dp(10)
        padding: dp(10)
        md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]


                
        MDBoxLayout:
            id: print
            size_hint: 1,1
            orientation: 'vertical'
            md_bg_color: [0.9333333333333333, 0.9333333333333333, 0.9333333333333333, 1.0]

            
            FitImage: 
                id: graph_print
                size_hint: 1, .3
                source: "screenshot.png"
                keep_ratio: True

                
            
            MDCard:
                size_hint: 1, .7
                padding: dp(10)
                orientation: 'vertical'

                MDLabel:
                    size_hint_y: None
                    height: dp(20)
                    text: str(app.start_date)
                    halign: 'center' 
                    md_bg_color: [0.8784313725490196, 0.8784313725490196, 0.8784313725490196, 1.0]
            
                MDBoxLayout:
                    size_hint: 1, 1
                    padding: 0,dp(10)
                    orientation: 'vertical'
                    MDGridLayout:
                        cols: 3
                        size_hint: 1, None
                        height: dp(30)
                        spacing: dp(10)
                        md_bg_color: [0.8784313725490196, 0.8784313725490196, 0.8784313725490196, 1.0]

                        MDLabel:
                            size_hint: 1, 1
                            height: dp(15)
                            text: "Marée"
                            halign: 'center'
                        MDLabel:
                            size_hint: 1, 1
                            height: dp(15)
                            text: "heure"
                            halign: 'center'
                        MDLabel:
                            size_hint: 1, 1
                            
                            text: "Hauteur"
                            halign: 'center'
                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint: 1,1                               
                        ScrollView:

                            MDBoxLayout:
                                orientation: 'vertical'
                                size_hint: 1,None
                                height: self.minimum_height
                                id: maree_list


    FloatLayout:
        size_hint: 1, 1
        MDRaisedButton:
            text: "save"
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1
            md_bg_color: 0.71, 0.71, 0.012, 1
            pos_hint: {'center_x': 0.5, 'center_y': 0.5}
            on_release: print.export_to_png("export.png")

                

    

              
          


<ModalAdd@ModalView>:
    size_hint: .8, .8
    md_bg_color: 1,1 , 1, 1
# <Add_country@MDBoxLayout>:
#     size_hint: 1, 1
#     orientation: 'vertical'
#     spacing: dp(10)
#     md_bg_color: 1,1 , 1, 1

#     MDTextField:
#         hint_text: "No helper text"
#         mode: "rectangle"

<Add_country_dialog>:
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "120dp"

    MDTextField:
        id: country
        hint_text: "Pays"


<Add_port_dialog>:
    orientation: "vertical"
    spacing: "12dp"
    size_hint_y: None
    height: "120dp"

    MDTextField:
        id: port
        hint_text: "Port"







 



<Constituant_MDGridLayout>:
    size_hint: 1, None
    height: dp(30)
    spacing: dp(10)
    cols : 3
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .33, None
        height: dp(10)
        MDLabel:
            id: constituant
            text: root.constituant_name
            font_style: "Caption"
            halign: 'center'
 
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .33, None
        height: dp(10)
        MDLabel:
            
            text: root.amplitude_optimized
            font_style: "Caption"
            halign: 'center'
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .33, None
        height: dp(10)
        MDLabel:
         
            text: root.phase_optimized
            font_style: "Caption"
            halign: 'center'

<Data_MDGridLayout>:
    size_hint: 1, None
    height: dp(30)
    spacing: dp(10)
    cols : 4
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .166, None
        height: dp(10)
        MDLabel:
         
            text: root.date
            font_style: "Caption"
            halign: 'center'
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .166, None
        height: dp(10)
        MDLabel:
         
            text: root.time
            font_style: "Caption"
            halign: 'center'
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .166, None
        height: dp(10)
        MDLabel:
           
            text: root.predicted
            font_style: "Caption"
            halign: 'center'
    MDBoxLayout:
        orientation: 'vertical'
        size_hint: .166, None
        height: dp(10)
        MDLabel:
            
            text: root.verified
            font_style: "Caption"
            halign: 'center'



<RVConstituant>:
    viewclass: 'Constituant_MDGridLayout'
    RecycleBoxLayout:
        default_size: None, dp(30)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
        spacing: dp(10)
    
<RVData>:
    viewclass: 'Data_MDGridLayout'
    RecycleBoxLayout:
        default_size: None, dp(30)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'vertical'
        spacing: dp(10)
    



                

<Add_port>:
    md_bg_color: 1,1 , 1, 1
    size_hint: 1, 1
    MDBoxLayout:
        orientation: 'vertical'
        spacing: dp(10)
        padding: dp(10)
        md_bg_color: 1,1 , 1, 1
        
        MDGridLayout:
            cols: 3
            spacing: dp(10)
            size_hint: 1, None
            height: dp(30)
            MDBoxLayout:
                orientation: 'vertical'
                
                size_hint: .1, None
                height: dp(30)
                MDLabel:
                    text: "Pays"

            MDCard:
                size_hint: 1, None
                height: dp(30)
                on_release:  app.search_dropdown.Oopen("country","add_port")     
                padding: dp(10),0
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1.0
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
                    # RoundedRectangle:
                    #     size: self.size
                    #     pos: self.pos
                    #     radius: [25, 0, 0, 0]
                MDLabel:
                    text: root.selected_country
                    align: 'center'
                MDIconButton:
                    icon: 'arrow-down-drop-circle-outline'
                    pos_hint: {'center_y': 0.5}
                
            MDCard:
                size_hint: None, None
                width: dp(130)
                height: dp(30)
                on_release:  app.show_add_country_dialog()              
                md_bg_color: 0,.5 , .1, 1
                padding: dp(10),0 ,0,0
                MDLabel:
                    text: "Nouveau"
                MDIconButton:
                    icon: 'plus'
                    pos_hint: {'center_y': 0.5,}
                    on_release: app.show_add_country_dialog()
        MDGridLayout:
            cols: 3
            spacing: dp(10)
            size_hint: 1, None
            height: dp(30)
            MDBoxLayout:
                orientation: 'vertical'
                
                size_hint: .1, None
                height: dp(30)
                MDLabel:
                    text: "Port"

            MDCard:
                size_hint: 1, None
                height: dp(30)
                on_release:  app.search_dropdown.Oopen("port","add_port")         
                padding: dp(10),0
                
                canvas.before:
                    Color:
                        rgba: 0, 0, 0, 1.0
                    Line:
                        width: 1
                        rectangle: self.x, self.y, self.width, self.height
                    # RoundedRectangle:
                    #     size: self.size
                    #     pos: self.pos
                    #     radius: [25, 0, 0, 0]
                MDLabel:
                    text: root.selected_port
                    align: 'center'
                MDIconButton:
                    icon: 'arrow-down-drop-circle-outline'
                    pos_hint: {'center_y': 0.5}
                
            MDCard:
                size_hint: None, None
                width: dp(130)
                height: dp(30)
                on_release:  app.show_add_port_dialog()              
                md_bg_color: 0,.5 , .1, 1
                padding: dp(10),0 ,0,0
                MDLabel:
                    text: "Nouveau"
                    
                MDIconButton:
                    icon: 'plus'
                    pos_hint: {'center_y': 0.5,}
                    on_release: app.show_add_port_dialog()


        MDSeparator:
            
     
                
      




        MDBoxLayout:
            size_hint: 1, 1
            orientation: 'vertical'
            spacing: dp(10)
            MDLabel:
                size_hint: 1, None
                height: dp(15)
                text: "Constituant"
                halign: 'center'

            MDCard:
                size_hint: 1, 1
                padding: dp(10)


                orientation: 'vertical'
        

                MDGridLayout:
                    size_hint: 1, None
                    height: dp(20)
                    spacing: dp(10)
                    
                    cols : 3
                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint: .33, None
                        height: dp(10)
                        MDLabel:
                            text: "constituant"
                            font_style: "Caption"
                            halign: 'center'
                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint: .33, None
                        height: dp(10)
                        MDLabel:
                            text: "Amplitude"
                            font_style: "Caption"
                            halign: 'center'
                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint: .33, None
                        height: dp(10)
                        MDLabel:
                            text: "Phase"
                            font_style: "Caption"
                            halign: 'center'
            


                RVConstituant:
                    padding: dp(20),0
                    pos_hint: {'center_x': 0.5}

                    id : rv_constituant




        MDRelativeLayout:
            size_hint: 1, None
            height: dp(40)
            MDRectangleFlatIconButton: 
                text: "Entrainer"
                icon: "content-save"
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 1
                md_bg_color: 0, 1, 0, 1
                pos_hint: {'center_x': 0.5}
                height: dp(40)

                on_release: app.file_manager_open()



        



MDScreen:
    padding: 0
    HomeScreen:
        id: home_screen 
    
    

    # radius: [25, 0, 0, 0]
    # md_bg_color: app.theme_cls.primary_color
